<!DOCTYPE html>
<html lang='zh'>
        <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="stylesheet" href="//cdn.static.runoob.com/libs/bootstrap/3.3.7/css/bootstrap.min.css">
    <title>manually creating oradb on linux</title>
</head>

<body>
        <div id="header">
    <nav class="navbar navbar-default" role="navigation">
                <div class="container-fluid">
                        <div class="navbar-header">
                                <a class="navbar-brand" href="/">CLOUD</a>
                        </div>
                        <div class="collapse navbar-collapse" id="example-navbar-collapse">
                                <ul class="nav navbar-nav">
                                        <li><a href="/tweet"><i class="icon-retweet icon-white"></i>Tweets</a></li>
                                        <li><a href="/archive.html"><i class="icon-book icon-white"></i>Archives</a></li>
                                        <li><a href="/category.html"><i class="icon-th-list icon-white"></i>category</a></li>
                                        <li><a href="/about.html"><i class="icon-user icon-white"></i>About</a></li>
                                        <li class="dropdown">
                                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                                        Friend Links <b class="caret"></b>
                                                </a>
                                                <ul class="dropdown-menu">
                                                        <li><a href="http://www.ruanyifeng.com/home.html" target="_blank">阮一峰</a></li>
                                                        <li><a href="http://coolshell.cn/" target="_blank">陈皓haoel</a></li>
                                                        <li><a href="http://www.dbanotes.net/" target="_blank">冯大辉Fenng</a></li>
                                                        <li><a href="http://robbin.iteye.com/" target="_blank">范凯robbin</a></li>
                                                        <li><a href="http://www.eygle.com/" target="_blank">盖国强eygle</a></li>
                                                        <li><a href="http://blog.csdn.net/tianlesoftware" target="_blank">David Dai</a></li>
                                                        <li><a href="http://www.joelonsoftware.com/" target="_blank">Joel Spolsky</a></li>
                                                        <li><a href="http://mindhacks.cn/" target="_blank">刘未鹏MindHacks</a></li>
                                                        <li><a href="http://www.my1510.cn/author.php?roseluqiu" target="_blank">闾丘露薇</a></li>
                                                        <li><a href="http://www.dapenti.com/blog/" target="_blank">铂程斋dapenti</a></li>
                                                </ul>
                                        </li>
                                </ul>
                        </div>
                </div>
        </nav>
</div>


        <div id="content">
                <div class="container">
                        <div class="row">
                                <div>
                                        <div class="entry">
        <div class="entry entry-detail">
                    <div class="entry-header">
                            <h1 class="entry-title">manually creating oradb on linux</h1>
                            <div class="entry-meta">
                                    <span class="entry-by">
                                            <i class="icon-user"></i> <a href="/">dylan</a> on 2012-10-01 14:35:57
                                    </span>
                            </div>
                    </div>
                <div class="entry-content">
                        <h2>写在前面的话</h2>
<p>今年上半年，由于工作调整，开始接手DBA的工作，负责ERP、数据库、服务器等的管理和维护工作。在粗略看完Oracle Database 2 Day DBA的官方文档后，结合一些中文书目以及工作中遇到的问题，对Oracle数据库有了初步的了解。但发现单看中文数目以及解决一个个突发问题，还远远不够，于是开始阅读2 Day DBA的升级版文档Administrator's Guide，并进行一些尝试和实践，希望能够有进一步的理解。</p>
<p>在Adminstartor's Guide的第二章，讲到了如何使用<code>CREATE DATABASE</code>语句手工创建数据库。这个语句比MySQL的复杂多了，涵盖了Oracle数据库最核心的概念，需要有一定的基础知识。按照参考文档的提示进行操作时，还是出现过一些错误，最后参考CSDN上的一篇<a href="http://blog.csdn.net/tianlesoftware/article/details/4680213">博客</a>进行调整，成功创建了数据库，这里记录如下。</p>
<h2>测试环境</h2>
<ul>
<li>操作系统 CentOS 6.0 x86 64bit</li>
<li>数据库     Oracle 10.2</li>
</ul>
<h2>创建步骤</h2>
<h3>1. 规划sid,oracle home</h3>
<pre><code>export ORACLE_SID=MANUAL
export ORACLE_BASE=/db/oracle
export ORACLE_HOME=/db/oracle/product/10.2.0/db_1
</code></pre>
<h3>2. 系统规划</h3>
<pre><code>ORACLE_SID=manual
DB_NAME=MANUAL
DB_DOMAIN=egolife.com
</code></pre>
<h3>3. 手工创建必须的目录</h3>
<p>dump目录</p>
<pre><code>mkdir /db/oracle/admin/MANUAL/adump
mkdir /db/oracle/admin/MANUAL/bdump
mkdir /db/oracle/admin/MANUAL/cdump
mkdir /db/oracle/admin/MANUAL/udump
mkdir /db/oracle/admin/MANUAL/pfile
</code></pre>
<p>数据文件目录</p>
<pre><code>mkdir /db/oracle/oradata/MANUAL
</code></pre>
<p>恢复目录</p>
<pre><code>mkdir /db/oracle/flash_recovery_area/MANUAL
</code></pre>
<h3>4. 建立密码文件</h3>
<pre><code>orapwd file=/db/oracle/product/10.2.0/db_1/dbs/orapwMANUAL password=oracle
</code></pre>
<h3>5. 修改参数文件</h3>
<p>编辑init.ora文件，更改主要配置：</p>
<pre><code>MANUAL.__db_cache_size=331350016
MANUAL.__java_pool_size=4194304
MANUAL.__large_pool_size=8388608
MANUAL.__shared_pool_size=138412032
MANUAL.__streams_pool_size=0
*._kgl_large_heap_warning_threshold=8388608
*.audit_file_dest='/db/oracle/admin/MANUAL/adump'
*.background_dump_dest='/db/oracle/admin/MANUAL/bdump'
*.compatible='10.2.0.1.0'
*.control_files='/db/oracle/oradata/MANUAL/control01.ctl',
'/db/oracle/oradata/MANUAL/control02.ctl',
'/db/oracle/oradata/MANUAL/control03.ctl'
*.core_dump_dest='/db/oracle/admin/MANUAL/cdump'
*.db_2k_cache_size=33554432
*.db_block_size=8192
*.db_domain='egolife.com'
*.db_file_multiblock_read_count=128
*.db_files=4000
*.db_name='MANUAL'
*.db_recovery_file_dest_size=4294967296
*.db_recovery_file_dest='/db/oracle/flash_recovery_area'
*.log_checkpoints_to_alert=FALSE
*.open_cursors=300
*.parallel_execution_message_size=65535
*.parallel_max_servers=128
*.pga_aggregate_target=209715200
*.processes=150
*.recyclebin='OFF'
*.remote_login_passwordfile='EXCLUSIVE'
*.replication_dependency_tracking=FALSE
*.session_cached_cursors=100
*.sga_target=500m
*.shared_pool_size=100m
*.undo_management='AUTO'
*.undo_retention=0
*.undo_tablespace='UNDOTS'
*.user_dump_dest='/db/oracle/admin/MANUAL/udump'
*.workarea_size_policy='AUTO'
_allow_resetlogs_corruption=true
</code></pre>
<h3>6. 启动数据库</h3>
<pre><code>SQL&gt; conn /as sysdba
Connected to an idle instance.
SQL&gt; startup nomount pfile=/db/oracle/product/10.2.0/db_1/dbs/initMANUAL.ora;

ORACLE instance started.

Total System Global Area  524288000 bytes
Fixed Size     1220336 bytes
Variable Size   150995216 bytes
Database Buffers   364904448 bytes
Redo Buffers     7168000 bytes
</code></pre>
<h3>7. 运行创建数据库脚本</h3>
<pre><code>CREATE DATABASE MANUAL
LOGFILE
GROUP 1 ('/db/oracle/oradata/MANUAL/redo01.log',
'/db/oracle/oradata/MANUAL/redo01_1.log') size 100m reuse,
GROUP 2 ('/db/oracle/oradata/MANUAL/redo02.log',
'/db/oracle/oradata/MANUAL/redo02_1.log') size 100m reuse,
GROUP 3 ('/db/oracle/oradata/MANUAL/redo03.log',
'/db/oracle/oradata/MANUAL/redo03_1.log') size 100m reuse
MAXLOGFILES 50
MAXLOGMEMBERS 5
MAXLOGHISTORY 200
MAXDATAFILES 500
MAXINSTANCES 5
ARCHIVELOG
CHARACTER SET UTF8
NATIONAL CHARACTER SET UTF8
DATAFILE '/db/oracle/oradata/MANUAL/system01.dbf' SIZE 1000M EXTENT MANAGEMENT LOCAL
SYSAUX DATAFILE '/db/oracle/oradata/MANUAL/sysaux01.dbf' SIZE 1000M
UNDO TABLESPACE UNDOTS DATAFILE '/db/oracle/oradata/MANUAL/undo.dbf' SIZE 500M
DEFAULT TEMPORARY TABLESPACE TEMP TEMPFILE '/db/oracle/oradata/MANUAL/temp.dbf' SIZE 500M;
</code></pre>
<h3>8. 运行必要的sql脚本(注意按以下顺序)</h3>
<pre><code>/db/oracle/product/10.2.0/db_1/rdbms/admin/catalog.sql
/db/oracle/product/10.2.0/db_1/rdbms/admin/catproc.sql
</code></pre>
<h3>9. 创建相关表空间和用户</h3>
<pre><code>create tablespace users datafile '/db/oracle/oradata/MANUAL/users01.dbf' size 500M;
create tablespace indexes datafile '/db/oracle/oradata/MANUAL/index01.dbf' size 500M;
</code></pre>
<p>建立测试用户</p>
<pre><code>create user dylan identified by 000000 default tablespace users;
grant connect,resource to dylan;
</code></pre>
<h3>10. 改为spfile启动</h3>
<pre><code>create spfile from pfile;
</code></pre>
<p>重启数据库，并运行show parameter spfile，确认启动的参数文件类型。</p>
<h3>11. Windows客户端测试</h3>
<p>tnsnames.ora配置：</p>
<pre><code>MANUAL =
  (DESCRIPTION =
    (ADDRESS = (PROTOCOL = TCP)(HOST = dev.egolife.com)(PORT = 1521))
    (CONNECT_DATA =
      (SERVER = DEDICATED)
      (SERVICE_NAME = MANUAL.egolife.com )
    )
  )
</code></pre>
<p>运行tnsping MANUAL命令，并使用sqlplus进行连接测试。</p>
<h2>参考</h2>
<ul>
<li><a href="http://docs.oracle.com/cd/B19306_01/server.102/b14231/create.htm#sthref220">Manually Creating an Oracle Database</a></li>
<li><a href="http://blog.csdn.net/tianlesoftware/article/details/4680213">Linux下手工新建数据库</a></li>
</ul> 
                </div>
        </div>
</div>

                                </div>
                        </div>
                </div>
        </div>
        <div id="footer">

        <div class="modal-footer">
                <p class="text-center">
                        Blog of <a href="/">dylan</a>.
                        Follow me on <a href="https://twitter.com/dylanninin" target="_blank">twitter</a>
                        or <a href="http://weibo.com/dylanninin" target="_blank">weibo</a>
                </p>
                <p class="text-center">
                        UI Designed by <a href="http://twitter.github.com/bootstrap" target="_blank">Twitter
                                Bootstrap</a>.
                        Powered by <a href="http://webpy.org" target="_blank">Web.py</a>.
                        Hosted by <a href="http://www.linode.com" target="_blank">Linode</a>.
                        Licensed under <a
                                href="http://creativecommons.org/licenses/by-nc-nd/3.0/" target="_blank">CC BY
                                3.0</a>
                </p>
                <p class="text-center">
                        Copyright &copy <a href="/">CLOUD</a> |
                        <a href="/about.html">About</a>
                </p>

        </div>
        <script src="/static/js/jquery.js"></script>
        <script src="/static/js/jquery-3.1.1.min.js"></script>
    <script src="/static/js/bootstrap.js"></script>
</div>

</body>
</html>
