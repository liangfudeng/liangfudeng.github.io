<!DOCTYPE html>
<html lang='zh'>
        <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="stylesheet" href="//cdn.static.runoob.com/libs/bootstrap/3.3.7/css/bootstrap.min.css">
    <title>mt installation</title>
</head>

<body>
        <div id="header">
    <nav class="navbar navbar-default" role="navigation">
                <div class="container-fluid">
                        <div class="navbar-header">
                                <a class="navbar-brand" href="/">CLOUD</a>
                        </div>
                        <div class="collapse navbar-collapse" id="example-navbar-collapse">
                                <ul class="nav navbar-nav">
                                        <li><a href="/tweet"><i class="icon-retweet icon-white"></i>Tweets</a></li>
                                        <li><a href="/archive.html"><i class="icon-book icon-white"></i>Archives</a></li>
                                        <li><a href="/category.html"><i class="icon-th-list icon-white"></i>category</a></li>
                                        <li><a href="/about.html"><i class="icon-user icon-white"></i>About</a></li>
                                        <li class="dropdown">
                                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                                        Friend Links <b class="caret"></b>
                                                </a>
                                                <ul class="dropdown-menu">
                                                        <li><a href="http://www.ruanyifeng.com/home.html" target="_blank">阮一峰</a></li>
                                                        <li><a href="http://coolshell.cn/" target="_blank">陈皓haoel</a></li>
                                                        <li><a href="http://www.dbanotes.net/" target="_blank">冯大辉Fenng</a></li>
                                                        <li><a href="http://robbin.iteye.com/" target="_blank">范凯robbin</a></li>
                                                        <li><a href="http://www.eygle.com/" target="_blank">盖国强eygle</a></li>
                                                        <li><a href="http://blog.csdn.net/tianlesoftware" target="_blank">David Dai</a></li>
                                                        <li><a href="http://www.joelonsoftware.com/" target="_blank">Joel Spolsky</a></li>
                                                        <li><a href="http://mindhacks.cn/" target="_blank">刘未鹏MindHacks</a></li>
                                                        <li><a href="http://www.my1510.cn/author.php?roseluqiu" target="_blank">闾丘露薇</a></li>
                                                        <li><a href="http://www.dapenti.com/blog/" target="_blank">铂程斋dapenti</a></li>
                                                </ul>
                                        </li>
                                </ul>
                        </div>
                </div>
        </nav>
</div>


        <div id="content">
                <div class="container">
                        <div class="row">
                                <div>
                                        <div class="entry">
        <div class="entry entry-detail">
                    <div class="entry-header">
                            <h1 class="entry-title">mt installation</h1>
                            <div class="entry-meta">
                                    <span class="entry-by">
                                            <i class="icon-user"></i> <a href="/">dylan</a> on 2012-09-29 14:35:57
                                    </span>
                            </div>
                    </div>
                <div class="entry-content">
                        <h2>MovableType 安装记录</h2>
<p>安装环境</p>
<ul>
<li>博客：MTOS-4.38-en</li>
<li>服务器：Linux dev.egolife.com 2.6.32-71.el6.i686 GNU/Linux</li>
<li>数据库： MySQL 5.1.47</li>
<li>Web服务器: Apache/2.2.15 (CentOS) Server at localhost Port 80</li>
</ul>
<h2>安装步骤</h2>
<p>解压</p>
<pre><code>[root@dev]# unzip MTOS-4.38-en.zip /var/www/cgi-bin
</code></pre>
<p>创建cgi-bin软连接</p>
<pre><code>[root@dev]# ln -s /var/www/cgi-bin/MTOS-4.38-en /var/www/cgi-bin/mt
[root@dev]# ll /var/www/cgi-bin/
total 4
lrwxrwxrwx 1 root root 13 Sep 22 23:57 mt -&gt; MTOS-4.38-en/
drwxr-xr-x 13 root root 4096 Sep 23 00:03 MTOS-4.38-en
</code></pre>
<p>创建静态文件软连接</p>
<pre><code>[root@dev]# ln -s /var/www/cgi-bin/MTOS-4.38-en/mt-static /var/www/html/mt-static
[root@dev]# ll /var/www/html/
total 0
lrwxrwxrwx 1 root root 40 Sep 22 23:58 mt-static -&gt; /var/www/cgi-bin/MTOS-4.38-en/mt-static/
</code></pre>
<p>权限更改</p>
<pre><code>[root@dev]# chmod 777 /var/www/cgi-bin/MTOS-4.38-en/mt-static/support
[root@dev]# chmod 777 /var/www/cgi-bin/MTOS-4.38-en/themes
</code></pre>
<h2>配置文件</h2>
<p>主要配置Movable Type的cgi-bin、静态文件的路径，数据库连接认证信息。</p>
<p>查看当前主机名</p>
<pre><code>[root@dev mt]# hostname
dev.egolife.com
</code></pre>
<p>重命名配置文件</p>
<pre><code>[root@dev]# cd /var/www/cgi-bin/MTOS-4.38-en
[root@dev mt]# cp mt-config.cgi-original mt-config.cgi
</code></pre>
<p>编辑配置文件，配置数据库</p>
<pre><code>[root@dev mt]# vim mt-config.cgi
CGIPath http://dev.egolife.com/cgi-bin/mt/
StaticWebPath http://dev.egolife.com/mt-static/
ObjectDriver DBI::mysql
Database xxxxxxxxx
DBUser xxxxxxxxx
DBPassword xxxxxxxxx
DBHost localhost
EmailAddressMain dylanninin@gmail.com

#####################################################################
</code></pre>
<h2>创建MT数据库、用户并授权</h2>
<pre><code>[root@dev]# mysql -uroot -p
mysql&gt; create database mt character utf8;
mysql&gt; create user mt;
mysql&gt; grant all on mt.* to xxxxxxxxx@'localhost' identified by 'xxxxxxxxx';
</code></pre>
<h2>启动web服务器</h2>
<pre><code>[root@dev mt]# apachectl start
</code></pre>
<h2>第一次访问</h2>
<p>使用浏览器打开以下url:</p>
<pre><code>http://dev.egolife.com/cgi-bin/mt/mt.cgi
</code></pre>
<p>此时出现异常，信息如下：</p>
<pre><code>Forbidden

You don't have permission to access /cgi-bin/mt/mt.cgi on this server.
Apache/2.2.15 (CentOS) Server at dev.egolife.com Port 80
</code></pre>
<p>查看httpd日志信息</p>
<pre><code>[root@dev]# less /var/log/httpd/error_log
[Sun Sep 23 00:11:31 2012] [error] [client 192.168.136.1] Directory index forbidden by Options directive: /var/www/html/
[Sun Sep 23 00:11:39 2012] [error] [client 192.168.136.1] Symbolic link not allowed or link target not accessible: /var/www/cgi-bin/mt
[Sun Sep 23 00:13:44 2012] [error] [client 127.0.0.1] File does not exist: /var/www/html/server-status
</code></pre>
<h2>主要错误信息</h2>
<h3>不允许mt符号连接</h3>
<p>更改<code>httpd.conf</code>中<code>/var/www/cgi-bin</code>的配置，启用符号链接，如下:</p>
<pre><code>581 #
582 &lt;Directory "/var/www/cgi-bin"&gt;
583 AllowOverride None
584 # Options None
585 Options FollowSymLinks 
586 Order allow,deny
587 Allow from all
588 &lt;/Directory&gt;
</code></pre>
<p>重启apache</p>
<pre><code>[root@dev httpd]# apachectl restart
</code></pre>
<p>再次访问，则可以正常浏览。</p>
<h3>文件server-status不存在</h3>
<pre><code>[root@dev httpd]# ll /var/www/html/
total 0
lrwxrwxrwx 1 root root 40 Sep 22 23:58 mt-static -&gt; /var/www/cgi-bin/MTOS-4.38-en/mt-static/
[root@dev]# mkdir /var/www/html/server-status
[root@dev]# chown apache:apache /var/www/html/server-status/
[root@dev]# ll /var/www/html/
total 4
lrwxrwxrwx 1 root root 40 Sep 22 23:58 mt-static -&gt; /var/www/cgi-bin/MTOS-4.38-en/mt-static/
drwxr-xr-x 2 apache apache 4096 Sep 23 00:31 server-status
</code></pre>
<p>访问时，已经显示Movable Type配置页面，但出现新的错误提示:</p>
<pre><code>An error occurred
Can't connect to data source '' because I can't work out what driver to use (it doesn't seem to contain a 'dbi:driver:' prefix and the DBI_DRIVER env var is not set)
</code></pre>
<p>可能是因为没有安装DBI扩展库，但查看rpm包时已经安装:</p>
<pre><code>[root@dev httpd]# rpm -qa | grep DBI
perl-DBI-1.609-4.el6.i686
perl-DBIx-Simple-1.32-3.el6.noarch
</code></pre>
<p>有可能是前面的<code>mt-config.cgi</code>配置出现问题:</p>
<pre><code>27 ##### MYSQL #####
28 ObjectDriver DBI::mysql
29 Database mt
30 DBUser mt
31 DBPassword 000000
32 DBHost localhost
33 EmailAddressMain dylanninin@gmail.com
34 
35 ##### POSTGRESQL #####
36 #ObjectDriver DBI::postgres
37 #Database DATABASE_NAME
38 #DBUser DATABASE_USERNAME
39 #DBPassword DATABASE_PASSWORD
40 #DBHost localhost
41 
42 ##### SQLITE #####
43 #ObjectDriver DBI::sqlite
44 #Database /path/to/sqlite/database/file
</code></pre>
<p>发现更改DB配置时，没有将PostgreSQL和SQLite的配置注释掉，注释掉后重启Apache，则可以正常配置。</p>
<h2>创建博客</h2>
<p>创建博客时，出现异常。主要信息如下:</p>
<pre><code>Blog Name:
My First Blog
Blog URL
http://dev.egolife.com/blog/
Publishing Path
/var/www/html/blog
</code></pre>
<p>错误信息：</p>
<pre><code>In order to properly publish your blog, you must provide Movable Type with your blog's URL and the path on the filesystem where its files should be published.
--The path provided below is not writable.
Blog Name
Blog URL
Publishing Path
Your 'Publishing Path' is the path on your web server's file system where Movable Type will publish all the files for your blog. Your web server must have write access to this directory.
</code></pre>
<p>创建目录</p>
<pre><code>[root@dev html]# cd /var/www/html
[root@dev html]# mkdir blog
[root@dev html]# chown apache:apache blog/
[root@dev html]# ll
total 8
drwxr-xr-x 2 apache apache 4096 Sep 23 00:46 blog
</code></pre>
<p>到此，初步安装MovableType成功。</p> 
                </div>
        </div>
</div>

                                </div>
                        </div>
                </div>
        </div>
        <div id="footer">

        <div class="modal-footer">
                <p class="text-center">
                        Blog of <a href="/">dylan</a>.
                        Follow me on <a href="https://twitter.com/dylanninin" target="_blank">twitter</a>
                        or <a href="http://weibo.com/dylanninin" target="_blank">weibo</a>
                </p>
                <p class="text-center">
                        UI Designed by <a href="http://twitter.github.com/bootstrap" target="_blank">Twitter
                                Bootstrap</a>.
                        Powered by <a href="http://webpy.org" target="_blank">Web.py</a>.
                        Hosted by <a href="http://www.linode.com" target="_blank">Linode</a>.
                        Licensed under <a
                                href="http://creativecommons.org/licenses/by-nc-nd/3.0/" target="_blank">CC BY
                                3.0</a>
                </p>
                <p class="text-center">
                        Copyright &copy <a href="/">CLOUD</a> |
                        <a href="/about.html">About</a>
                </p>

        </div>
        <script src="/static/js/jquery.js"></script>
        <script src="/static/js/jquery-3.1.1.min.js"></script>
    <script src="/static/js/bootstrap.js"></script>
</div>

</body>
</html>
